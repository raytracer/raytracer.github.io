<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Christoph Müller" />
  <meta name="keywords" content="vietnamese, intonation, cgp, rnn, android" />
  <title>Trying to build an Android App for Vietnamese Intonation
Practice</title>
  <style>
      figure{text-align: center;}
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="/mvp.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
    <header>
        <nav>
            <h3>raytracer.me</h3>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/blog">Blog</a></li>
            </ul>
        </nav>
                        <h1 class="title">Trying to build an Android App
for Vietnamese Intonation Practice</h1>
                    </header>
<main>
<p>For quite a while I have been studying Vietnamese now. Mostly just a
couple of minutes after work. And while grammar and vocabulary is slowly
improving the difficult intonation of vietnamese makes learning it quite
frustrating. Words like ma, má, mà, mã, mạ and mả all are pronounced
slightly differently. Practicing is of course best done with a native
speaker, but what if you do not have anyone to practice with?</p>
<p>Here the idea to create an android app comes into play. My first try
was to use the in-built android voice recognition service and compare
what the user said to what he/she should have been saying. But that
quickly showed that the in-built speech recognition is not suitable at
all for this kind of task. It is highly optimzied for sentences and
common word combinations. So it will default to correct to phrases that
sound similar if those are more common. Great for dictating a long
paragraph, but useless for intonation practice.</p>
<p>The next idea was to analyze the spectrum of the spoken word(s) and
compare it to what a native spectrum looks like. The first idea was to
compare the spectrum itself, but I quickly turned to a machine learning
like approach. I found some articles recommending a RNN based solution
where a slice of the spectrum would be mapped to a letter. The problems
I had with this approach:</p>
<ul>
<li>it could have similiar issues like the in-built Android speech
recogntion namely preferring more likely sounds based on preceding ones
instead of the actual spoken ones</li>
<li>it requires a ton of training data</li>
<li>it requires that the training data and test data is labeled
(obviously)</li>
</ul>
<figure>
<img src="2021-07-24_vietnamese_language_intonation_app.assets/má.png"
alt="Spectrum of the word má" />
<figcaption aria-hidden="true">Spectrum of the word
<strong>má</strong></figcaption>
</figure>
<h2 id="ggp-cartesian-genetic-programming">GGP (Cartesian Genetic
Programming)</h2>
<p>So instead I turned to my favorite algorithm called CGP (Cartesian
Genetic Programming). This algorithm basically generates a computation
graph generated from a fixed <span
class="math inline"><em>n</em> × <em>m</em></span> grid. Every cell has
a type and a number of indices for its arguments/parameters. Furthermore
every cell of a column of the grid can only index cells from previous
columns (so to the left of it). The rightmost column of output nodes
then determine a computation tree for every output node (the last column
can have a different number of rows compared to the rest of the grid,
same goes for the input column). All cell types and their indices into
previous columns are then mutated in every iteration. If a gene has a
better or <strong>equal</strong> (important) fitness value compared to
the original gene it is chosen for the next iteration. There is a great
paper discussing the current state of CGP that you can find <a
href="https://link.springer.com/content/pdf/10.1007/s10710-019-09360-6.pdf">here</a>.
CGP can produce fairly general solutions including neural networks.
There are even approaches for integrating gradient descent into CGP, but
I have not yet explored this direction.</p>
<p>My CGP program is written in Java and returns a python fragment that
I can test against my data. The only really interesting part is the
fitness function which is roughly described by taking all the predicted
characters for every slice of the spectrum, concatenating them, removing
duplicates and trimming the end result. That result is than compared to
the actual word by using the levenshtein distance. That is the fitness
value of a gene. I modified that slightly later, but it is still mostly
how it works. The code is included at the end of the blog post.</p>
<h2 id="results">Results</h2>
<p>Let’s be honest here, the results where absolutely terrible. This is
a hard problem. The CGP program is probably the smallest problem here,
but finding the right width and overlap of the spectrum slices is alone
a complicated issue. I used scipys <code>signal</code> package to
compute the spectra and export them to json. I let the CGP program run
for a couple of days on my server with variying number of rows, columns,
levelsBack and mutation rates. But it was not really going anywhere.</p>
<p>A better appoach for an app like this would probably just comparing
the spectra themselves instead of trying to find a general solution for
speech recognition.</p>
<p>Nevertheless here is the java code. The python code is only a couple
of lines and basically just calles
<code>signal.spectrogram(samples, sample_rate)</code> and dumps that to
json, so not too exciting.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span><span class="im"> me</span><span class="op">.</span><span class="im">raytracer</span><span class="op">.</span><span class="im">cgpvietnamese</span><span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">io</span><span class="op">.</span><span class="im">IOException</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">nio</span><span class="op">.</span><span class="im">file</span><span class="op">.</span><span class="im">Files</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">nio</span><span class="op">.</span><span class="im">file</span><span class="op">.</span><span class="im">Paths</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">util</span><span class="op">.</span><span class="im">AbstractMap</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">util</span><span class="op">.</span><span class="im">Arrays</span><span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">util</span><span class="op">.</span><span class="im">Collections</span><span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">util</span><span class="op">.</span><span class="im">Map</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">util</span><span class="op">.</span><span class="im">TreeMap</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">util</span><span class="op">.</span><span class="im">concurrent</span><span class="op">.</span><span class="im">ThreadLocalRandom</span><span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">java</span><span class="op">.</span><span class="im">util</span><span class="op">.</span><span class="im">stream</span><span class="op">.</span><span class="im">Collectors</span><span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">org</span><span class="op">.</span><span class="im">apache</span><span class="op">.</span><span class="im">commons</span><span class="op">.</span><span class="im">text</span><span class="op">.</span><span class="im">similarity</span><span class="op">.</span><span class="im">LevenshteinDistance</span><span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">org</span><span class="op">.</span><span class="im">json</span><span class="op">.</span><span class="im">JSONArray</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">org</span><span class="op">.</span><span class="im">json</span><span class="op">.</span><span class="im">JSONException</span><span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Main <span class="op">{</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> rows <span class="op">=</span> <span class="dv">129</span><span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> columns <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">final</span> <span class="dt">static</span> <span class="dt">int</span> maxArity <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">final</span> <span class="dt">static</span> <span class="dt">int</span> nrOutputs <span class="op">=</span> <span class="dv">9</span><span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">final</span> <span class="dt">static</span> <span class="dt">int</span> nrInputs <span class="op">=</span> <span class="dv">129</span><span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">final</span> <span class="dt">static</span> <span class="dt">int</span> nrFunctions <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> maxLevel <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> mutationRate <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">final</span> <span class="dt">static</span> <span class="dt">int</span> geneLength <span class="op">=</span> rows <span class="op">*</span> columns <span class="op">*</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> nrOutputs<span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>args<span class="op">.</span><span class="fu">length</span> <span class="op">&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                rows <span class="op">=</span> <span class="bu">Integer</span><span class="op">.</span><span class="fu">parseInt</span><span class="op">(</span>args<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                columns <span class="op">=</span> <span class="bu">Integer</span><span class="op">.</span><span class="fu">parseInt</span><span class="op">(</span>args<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                mutationRate <span class="op">=</span> <span class="bu">Double</span><span class="op">.</span><span class="fu">parseDouble</span><span class="op">(</span>args<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                maxLevel <span class="op">=</span> <span class="bu">Integer</span><span class="op">.</span><span class="fu">parseInt</span><span class="op">(</span>args<span class="op">[</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Rows: &quot;</span> <span class="op">+</span> rows<span class="op">);</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Columns: &quot;</span> <span class="op">+</span> columns<span class="op">);</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>            <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Mutation Rate: &quot;</span> <span class="op">+</span> mutationRate<span class="op">);</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> testData <span class="op">=</span> <span class="fu">readTestData</span><span class="op">();</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> gene <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>geneLength<span class="op">];</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">generate</span><span class="op">(</span>gene<span class="op">);</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> fitness <span class="op">=</span> <span class="bu">Double</span><span class="op">.</span><span class="fu">MAX_VALUE</span><span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> iterations <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="op">(</span>fitness <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">var</span> copies <span class="op">=</span> <span class="fu">generateNCopies</span><span class="op">(</span>gene<span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> copies<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">var</span> copyFitness <span class="op">=</span> <span class="fu">testFitness</span><span class="op">(</span>copies<span class="op">[</span>i<span class="op">],</span> testData<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="op">(</span>copyFitness <span class="op">&lt;=</span> fitness<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> <span class="op">(</span>copyFitness <span class="op">&lt;</span> fitness<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                                <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Fitness: &quot;</span> <span class="op">+</span> copyFitness<span class="op">);</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                            <span class="op">}</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>                            fitness <span class="op">=</span> copyFitness<span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                            gene <span class="op">=</span> copies<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                        <span class="op">}</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                    e<span class="op">.</span><span class="fu">printStackTrace</span><span class="op">();</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>iterations <span class="op">%</span> <span class="dv">10000</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Nach Iteration:&quot;</span> <span class="op">+</span> iterations<span class="op">);</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="fu">print</span><span class="op">(</span>gene<span class="op">));</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>                iterations<span class="op">++;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">testFitness</span><span class="op">(</span>gene<span class="op">,</span> testData<span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>            <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;success after nr of iterations: &quot;</span> <span class="op">+</span> iterations<span class="op">);</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span><span class="op">(</span>gene<span class="op">);</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span>JSONException e1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>            e1<span class="op">.</span><span class="fu">printStackTrace</span><span class="op">();</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="bu">IOException</span> e1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>            e1<span class="op">.</span><span class="fu">printStackTrace</span><span class="op">();</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="bu">Map</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">,</span> JSONArray<span class="op">&gt;</span> <span class="fu">readTestData</span><span class="op">()</span> <span class="kw">throws</span> <span class="bu">IOException</span> <span class="op">{</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Files<span class="op">.</span><span class="fu">list</span><span class="op">(</span>Paths<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;.&quot;</span><span class="op">)).</span><span class="fu">filter</span><span class="op">(</span>p <span class="op">-&gt;</span> p<span class="op">.</span><span class="fu">getFileName</span><span class="op">().</span><span class="fu">toString</span><span class="op">().</span><span class="fu">endsWith</span><span class="op">(</span><span class="st">&quot;json&quot;</span><span class="op">)).</span><span class="fu">map</span><span class="op">(</span>p <span class="op">-&gt;</span> <span class="op">{</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">new</span> <span class="bu">AbstractMap</span><span class="op">.</span><span class="fu">SimpleEntry</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">,</span> JSONArray<span class="op">&gt;(</span>p<span class="op">.</span><span class="fu">getFileName</span><span class="op">().</span><span class="fu">toString</span><span class="op">().</span><span class="fu">replace</span><span class="op">(</span><span class="st">&quot;.json&quot;</span><span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">new</span> <span class="fu">JSONArray</span><span class="op">(</span>Files<span class="op">.</span><span class="fu">readString</span><span class="op">(</span>p<span class="op">)));</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="bu">IOException</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">RuntimeException</span><span class="op">(</span>e<span class="op">);</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>        <span class="op">}).</span><span class="fu">collect</span><span class="op">(</span>Collectors<span class="op">.</span><span class="fu">toMap</span><span class="op">(</span>k <span class="op">-&gt;</span> k<span class="op">.</span><span class="fu">getKey</span><span class="op">(),</span> k <span class="op">-&gt;</span> k<span class="op">.</span><span class="fu">getValue</span><span class="op">()));</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span><span class="op">[][]</span> <span class="fu">generateNCopies</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">,</span> <span class="dt">int</span> nr<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> list <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>nr<span class="op">][];</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nr<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            list<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="bu">Arrays</span><span class="op">.</span><span class="fu">copyOf</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">.</span><span class="fu">length</span><span class="op">);</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span><span class="op">(</span>list<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> list<span class="op">;</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">testFitness</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">,</span> <span class="bu">Map</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">,</span> JSONArray<span class="op">&gt;</span> testData<span class="op">,</span> <span class="dt">boolean</span> printRaw<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> fitness <span class="op">=</span> <span class="fl">0d</span><span class="op">;</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">var</span> entry <span class="op">:</span> testData<span class="op">.</span><span class="fu">entrySet</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> letters <span class="op">=</span> <span class="kw">new</span> <span class="bu">StringBuilder</span><span class="op">();</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> rawLetters <span class="op">=</span> <span class="kw">new</span> <span class="bu">StringBuilder</span><span class="op">();</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> frequency <span class="op">=</span> <span class="kw">new</span> <span class="bu">TreeMap</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">,</span> <span class="bu">Integer</span><span class="op">&gt;(</span><span class="bu">Collections</span><span class="op">.</span><span class="fu">reverseOrder</span><span class="op">());</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> entry<span class="op">.</span><span class="fu">getValue</span><span class="op">().</span><span class="fu">length</span><span class="op">();</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> inputJson <span class="op">=</span> entry<span class="op">.</span><span class="fu">getValue</span><span class="op">().</span><span class="fu">getJSONArray</span><span class="op">(</span>i<span class="op">);</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> inputs <span class="op">=</span> <span class="kw">new</span> <span class="dt">double</span><span class="op">[</span>nrInputs<span class="op">];</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> inputJson<span class="op">.</span><span class="fu">length</span><span class="op">();</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>                    inputs<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> inputJson<span class="op">.</span><span class="fu">getDouble</span><span class="op">(</span>j<span class="op">);</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> index <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> outputs <span class="op">=</span> <span class="fu">evaluate</span><span class="op">(</span>gene<span class="op">,</span> inputs<span class="op">);</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> outputs<span class="op">.</span><span class="fu">length</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="op">(</span>outputs<span class="op">[</span>j<span class="op">]</span> <span class="op">&gt;</span> outputs<span class="op">[</span>index<span class="op">])</span> <span class="op">{</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>                        index <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> s <span class="op">=</span> <span class="fu">indexToString</span><span class="op">(</span>index<span class="op">);</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>frequency<span class="op">.</span><span class="fu">containsKey</span><span class="op">(</span>s<span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>                    frequency<span class="op">.</span><span class="fu">put</span><span class="op">(</span>s<span class="op">,</span> frequency<span class="op">.</span><span class="fu">get</span><span class="op">(</span>s<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>                    frequency<span class="op">.</span><span class="fu">put</span><span class="op">(</span>s<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>printRaw<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>                    rawLetters<span class="op">.</span><span class="fu">append</span><span class="op">(</span>s<span class="op">);</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(!</span>letters<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">endsWith</span><span class="op">(</span>s<span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>                    letters<span class="op">.</span><span class="fu">append</span><span class="op">(</span>s<span class="op">);</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> top <span class="op">=</span> frequency<span class="op">.</span><span class="fu">keySet</span><span class="op">().</span><span class="fu">stream</span><span class="op">().</span><span class="fu">limit</span><span class="op">(</span>entry<span class="op">.</span><span class="fu">getKey</span><span class="op">().</span><span class="fu">length</span><span class="op">()).</span><span class="fu">toList</span><span class="op">();</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> si <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> si <span class="op">&lt;</span> entry<span class="op">.</span><span class="fu">getKey</span><span class="op">().</span><span class="fu">length</span><span class="op">();</span> si<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(!</span>top<span class="op">.</span><span class="fu">contains</span><span class="op">(</span>entry<span class="op">.</span><span class="fu">getKey</span><span class="op">().</span><span class="fu">substring</span><span class="op">(</span>si<span class="op">,</span> si <span class="op">+</span> <span class="dv">1</span><span class="op">)))</span> <span class="op">{</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>                    fitness <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>            fitness <span class="op">+=</span> <span class="kw">new</span> <span class="fu">LevenshteinDistance</span><span class="op">().</span><span class="fu">apply</span><span class="op">(</span>entry<span class="op">.</span><span class="fu">getKey</span><span class="op">(),</span> letters<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">trim</span><span class="op">());</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>printRaw<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>                <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>rawLetters<span class="op">);</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fitness<span class="op">;</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">indexToString</span><span class="op">(</span><span class="dt">int</span> index<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>index<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">0</span><span class="op">:</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;b&quot;</span><span class="op">;</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;m&quot;</span><span class="op">;</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">3</span><span class="op">:</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;a&quot;</span><span class="op">;</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">4</span><span class="op">:</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;á&quot;</span><span class="op">;</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">5</span><span class="op">:</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;à&quot;</span><span class="op">;</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">6</span><span class="op">:</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;ã&quot;</span><span class="op">;</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">7</span><span class="op">:</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;ạ&quot;</span><span class="op">;</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="dv">8</span><span class="op">:</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">&quot;ả&quot;</span><span class="op">;</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>            <span class="kw">default</span><span class="op">:</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span><span class="op">(</span><span class="st">&quot;unknown index: &quot;</span> <span class="op">+</span> index<span class="op">);</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">mutate</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> mutationRate <span class="op">*</span> gene<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> index <span class="op">=</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> geneLength<span class="op">);</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>            gene<span class="op">[</span>index<span class="op">]</span> <span class="op">=</span> <span class="fu">generateSingle</span><span class="op">(</span>index<span class="op">);</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> <span class="fu">generateSingle</span><span class="op">(</span><span class="dt">int</span> index<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>index <span class="op">&lt;</span> rows <span class="op">*</span> columns <span class="op">*</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>index <span class="op">%</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> nrFunctions<span class="op">);</span></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> maxColumn <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> index <span class="op">/</span> rows <span class="op">/</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> column <span class="op">=</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> maxColumn <span class="op">-</span> maxLevel<span class="op">),</span> maxColumn<span class="op">);</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>column <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> nrInputs<span class="op">);</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> rows<span class="op">)</span> <span class="op">*</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>                            <span class="op">+</span> rows <span class="op">*</span> <span class="op">(</span>column <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> nrInputs<span class="op">;</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> column <span class="op">=</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span> <span class="op">+</span> columns <span class="op">-</span> maxLevel<span class="op">),</span> <span class="dv">1</span> <span class="op">+</span> columns<span class="op">);</span></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>column <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> nrInputs<span class="op">);</span></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> ThreadLocalRandom<span class="op">.</span><span class="fu">current</span><span class="op">().</span><span class="fu">nextInt</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> rows<span class="op">)</span> <span class="op">*</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>                        <span class="op">+</span> rows <span class="op">*</span> <span class="op">(</span>column <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span>maxArity <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> nrInputs<span class="op">;</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">generate</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> gene<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>            gene<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="fu">generateSingle</span><span class="op">(</span>i<span class="op">);</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span><span class="op">[]</span> <span class="fu">evaluate</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">,</span> <span class="dt">double</span><span class="op">[]</span> inputs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> result <span class="op">=</span> <span class="kw">new</span> <span class="dt">double</span><span class="op">[</span>nrOutputs<span class="op">];</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> result<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>            result<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>geneLength <span class="op">-</span> nrOutputs <span class="op">+</span> i<span class="op">],</span> inputs<span class="op">);</span></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">evaluateSingle</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">,</span> <span class="dt">int</span> index<span class="op">,</span> <span class="dt">double</span><span class="op">[]</span> inputs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>index <span class="op">&lt;</span> nrInputs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> inputs<span class="op">[</span>index<span class="op">];</span></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">switch</span> <span class="op">(</span>gene<span class="op">[</span>index <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">{</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">0</span><span class="op">:</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">]</span> <span class="op">%</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">)</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>                            <span class="op">+</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">);</span></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">)</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>                            <span class="op">-</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">);</span></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">3</span><span class="op">:</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">)</span></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>                            <span class="op">*</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">);</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">4</span><span class="op">:</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">)</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>                            <span class="op">/</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">);</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">5</span><span class="op">:</span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="fu">evaluateSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">],</span> inputs<span class="op">);</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>                <span class="kw">default</span><span class="op">:</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span><span class="op">(</span><span class="st">&quot;Invalid function: &quot;</span> <span class="op">+</span> gene<span class="op">[</span>index <span class="op">-</span> nrInputs<span class="op">]);</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">print</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> result <span class="op">=</span> <span class="kw">new</span> <span class="bu">StringBuilder</span><span class="op">();</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nrOutputs<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span><span class="fu">append</span><span class="op">(</span><span class="st">&quot;outputs[&quot;</span><span class="op">);</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span><span class="fu">append</span><span class="op">(</span>i<span class="op">);</span></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span><span class="fu">append</span><span class="op">(</span><span class="st">&quot;] = &quot;</span><span class="op">);</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span><span class="fu">append</span><span class="op">(</span><span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>geneLength <span class="op">-</span> nrOutputs <span class="op">+</span> i<span class="op">]));</span></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span><span class="fu">append</span><span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result<span class="op">.</span><span class="fu">toString</span><span class="op">();</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">printSingle</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> gene<span class="op">,</span> <span class="dt">int</span> index<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>index <span class="op">&lt;</span> nrInputs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;inputs[&quot;</span> <span class="op">+</span> index <span class="op">+</span> <span class="st">&quot;]&quot;</span><span class="op">;</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>            <span class="cf">switch</span> <span class="op">(</span>gene<span class="op">[</span>index <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">{</span></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">0</span><span class="op">:</span></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="bu">String</span><span class="op">.</span><span class="fu">valueOf</span><span class="op">(</span>gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">]</span> <span class="op">%</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="st">&quot;(&quot;</span> <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot; + &quot;</span></span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>                            <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot;)&quot;</span><span class="op">;</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="st">&quot;(&quot;</span> <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>                            <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot;)&quot;</span><span class="op">;</span></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">3</span><span class="op">:</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="st">&quot;(&quot;</span> <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot; * &quot;</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>                            <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot;)&quot;</span><span class="op">;</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">4</span><span class="op">:</span></span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="st">&quot;(&quot;</span> <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot; / &quot;</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>                            <span class="op">+</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> nrInputs<span class="op">])</span> <span class="op">+</span> <span class="st">&quot;)&quot;</span><span class="op">;</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="dv">5</span><span class="op">:</span></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="fu">printSingle</span><span class="op">(</span>gene<span class="op">,</span> gene<span class="op">[</span>index <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> nrInputs<span class="op">]);</span></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">default</span><span class="op">:</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span><span class="op">(</span><span class="st">&quot;Invalid function: &quot;</span> <span class="op">+</span> gene<span class="op">[</span>index <span class="op">-</span> nrInputs<span class="op">]);</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</main>
<footer>
    <section>
        <a href="https://github.com/raytracer/website/edit/main/./blog/2021-07-24_vietnamese_language_intonation_app.md">Edit on GitHub</a>
    </section>
    <section>
        <a href="/impressum.html">Impressum und Datenschutz</a>
    </section>
    <section>
        Copyright © Christoph Müller 2024.
    </section>
</footer>
</body>
</html>
